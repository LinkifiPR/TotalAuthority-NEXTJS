{"version":3,"sources":["../../../../app/admin/users/page.tsx"],"sourcesContent":["\"use client\";\n\n\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { supabase } from '@/lib/integrations/supabase/client';\nimport { useToast } from '@/hooks/use-toast';\nimport { AdminSidebar } from '@/components/admin/AdminSidebar';\nimport { AdminHeader } from '@/components/admin/AdminHeader';\nimport { SidebarProvider, SidebarInset } from '@/components/ui/sidebar';\nimport { User, Mail, Calendar, Shield, Search, Filter, Upload, FileText, Trash2, Plus, CheckCircle } from 'lucide-react';\n\ninterface UserProfile {\n  id: string;\n  email: string;\n  full_name: string;\n  role: string;\n  created_at: string;\n  last_sign_in_at?: string;\n  paidAudits?: PaidAuditInfo[];\n}\n\ninterface PaidAuditInfo {\n  id: string;\n  client_name: string;\n  audit_data: any;\n  created_at: string;\n}\n\nconst AdminUsers = () => {\n  const [users, setUsers] = useState<UserProfile[]>([]);\n  const [filteredUsers, setFilteredUsers] = useState<UserProfile[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [roleFilter, setRoleFilter] = useState('all');\n  const [auditFilter, setAuditFilter] = useState('all'); // New filter for paid audits\n  const [sortBy, setSortBy] = useState<'name' | 'email' | 'date' | 'role'>('date');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n  const [selectedUser, setSelectedUser] = useState<UserProfile | null>(null);\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [actionType, setActionType] = useState<'upload' | 'manage'>('upload');\n  const { toast } = useToast();\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  useEffect(() => {\n    filterAndSortUsers();\n  }, [users, searchTerm, roleFilter, auditFilter, sortBy, sortOrder]);\n\n  const fetchUsers = async () => {\n    try {\n      console.log('Fetching user details via admin-stats function...');\n      \n      // Make a request for user details using the admin-stats function\n      const response = await fetch(`https://pgbcixncaeyjunwxrsik.supabase.co/functions/v1/admin-stats?users=true`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBnYmNpeG5jYWV5anVud3hyc2lrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwOTgzMDMsImV4cCI6MjA2NTY3NDMwM30.TUsBYptM7RIcVWZ0IQiGGNViSnlxr8ruN_zwiAup5Fc`,\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      const userData = await response.json();\n      \n      if (userData.error) {\n        throw new Error(userData.error);\n      }\n\n      setUsers(userData.users || []);\n      await fetchPaidAuditsForUsers(userData.users || []);\n    } catch (error: any) {\n      console.error('Error fetching users:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to fetch users\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchPaidAuditsForUsers = async (usersList: UserProfile[]) => {\n    try {\n      // Fetch all paid audits (including archived ones - users should always see their paid audits)\n      const { data: audits, error } = await supabase\n        .from('audit_reports')\n        .select('*')\n        .contains('audit_data', { type: 'uploaded_pdf' });\n\n      if (error) throw error;\n\n      // Map audits to users\n      const usersWithAudits = usersList.map(user => {\n        const userAudits = (audits || []).filter(audit => {\n          const auditData = audit.audit_data as any;\n          return auditData?.uploaded_for_user === user.id;\n        });\n        \n        return {\n          ...user,\n          paidAudits: userAudits\n        };\n      });\n\n      setUsers(usersWithAudits);\n    } catch (error) {\n      console.error('Error fetching paid audits:', error);\n    }\n  };\n\n  const filterAndSortUsers = () => {\n    let filtered = users.filter(user => {\n      const matchesSearch = user.full_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           user.email?.toLowerCase().includes(searchTerm.toLowerCase());\n      const matchesRole = roleFilter === 'all' || user.role === roleFilter;\n      \n      // New audit filter logic\n      let matchesAudit = true;\n      if (auditFilter === 'with-audits') {\n        matchesAudit = !!(user.paidAudits && user.paidAudits.length > 0);\n      } else if (auditFilter === 'without-audits') {\n        matchesAudit = !user.paidAudits || user.paidAudits.length === 0;\n      }\n      \n      return matchesSearch && matchesRole && matchesAudit;\n    });\n\n    filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortBy) {\n        case 'name':\n          aValue = a.full_name || '';\n          bValue = b.full_name || '';\n          break;\n        case 'email':\n          aValue = a.email || '';\n          bValue = b.email || '';\n          break;\n        case 'role':\n          aValue = a.role || '';\n          bValue = b.role || '';\n          break;\n        case 'date':\n        default:\n          aValue = new Date(a.created_at).getTime();\n          bValue = new Date(b.created_at).getTime();\n          break;\n      }\n\n      if (sortOrder === 'asc') {\n        return aValue > bValue ? 1 : -1;\n      } else {\n        return aValue < bValue ? 1 : -1;\n      }\n    });\n\n    setFilteredUsers(filtered);\n  };\n\n  const handlePdfUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file || !selectedUser) return;\n\n    if (file.type !== 'application/pdf') {\n      toast({\n        title: \"Invalid file type\",\n        description: \"Please upload a PDF file only.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setUploading(true);\n    try {\n      // Upload PDF to Supabase storage\n      const fileName = `user-${selectedUser.id}-audit-${Date.now()}.pdf`;\n      const { data, error: uploadError } = await supabase.storage\n        .from('blog-media')\n        .upload(`audit-reports/${fileName}`, file);\n\n      if (uploadError) throw uploadError;\n\n      // Create audit report entry for user\n      const { error: insertError } = await supabase\n        .from('audit_reports')\n        .insert({\n          client_name: selectedUser.full_name || selectedUser.email,\n          share_url_slug: `user-${selectedUser.id}-${Date.now()}`,\n          audit_data: {\n            type: 'uploaded_pdf',\n            file_path: data.path,\n            uploaded_for_user: selectedUser.id,\n            uploaded_at: new Date().toISOString()\n          },\n          status: 'active'\n        });\n\n      if (insertError) throw insertError;\n\n      toast({\n        title: \"PDF uploaded successfully\",\n        description: `Audit report has been added to ${selectedUser.full_name || selectedUser.email}'s dashboard.`,\n      });\n\n      setUploadDialogOpen(false);\n      setSelectedUser(null);\n      // Refresh the users list to show updated audit status\n      fetchUsers();\n    } catch (error: any) {\n      console.error('Error uploading PDF:', error);\n      toast({\n        title: \"Upload failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleRemoveAudit = async (auditId: string) => {\n    try {\n      const { error } = await supabase\n        .from('audit_reports')\n        .update({ status: 'archived' })\n        .eq('id', auditId);\n\n      if (error) throw error;\n\n      toast({\n        title: \"Audit removed successfully\",\n        description: \"The audit has been archived and removed from the user's dashboard.\",\n      });\n\n      setUploadDialogOpen(false);\n      setSelectedUser(null);\n      fetchUsers();\n    } catch (error: any) {\n      console.error('Error removing audit:', error);\n      toast({\n        title: \"Failed to remove audit\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const openUploadDialog = (user: UserProfile, type: 'upload' | 'manage') => {\n    setSelectedUser(user);\n    setActionType(type);\n    setUploadDialogOpen(true);\n  };\n\n  if (loading) {\n    return (\n      <SidebarProvider>\n        <AdminSidebar />\n        <SidebarInset>\n          <AdminHeader />\n          <div className=\"flex-1 p-8 pt-6\">\n            <div className=\"text-center py-8\">Loading users...</div>\n          </div>\n        </SidebarInset>\n      </SidebarProvider>\n    );\n  }\n\n  return (\n    <SidebarProvider>\n      <AdminSidebar />\n      <SidebarInset>\n        <AdminHeader />\n        <div className=\"flex-1 space-y-4 p-8 pt-6\">\n          <div className=\"flex items-center justify-between space-y-2\">\n            <h2 className=\"text-3xl font-bold tracking-tight\">Users</h2>\n          </div>\n\n          {/* Filters and Search */}\n          <Card>\n            <CardHeader>\n              <CardTitle>User Management</CardTitle>\n              <CardDescription>\n                Search, filter, and manage all registered users ({filteredUsers.length} of {users.length} total)\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-col md:flex-row gap-4 mb-6\">\n                <div className=\"flex-1\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                    <Input\n                      placeholder=\"Search users by name or email...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-10\"\n                    />\n                  </div>\n                </div>\n                \n                <Select value={roleFilter} onValueChange={setRoleFilter}>\n                  <SelectTrigger className=\"w-full md:w-48\">\n                    <Filter className=\"h-4 w-4 mr-2\" />\n                    <SelectValue placeholder=\"Filter by role\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Roles</SelectItem>\n                    <SelectItem value=\"admin\">Admin</SelectItem>\n                    <SelectItem value=\"user\">User</SelectItem>\n                  </SelectContent>\n                </Select>\n\n                <Select value={auditFilter} onValueChange={setAuditFilter}>\n                  <SelectTrigger className=\"w-full md:w-48\">\n                    <FileText className=\"h-4 w-4 mr-2\" />\n                    <SelectValue placeholder=\"Filter by audits\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Users</SelectItem>\n                    <SelectItem value=\"with-audits\">With Paid Audits</SelectItem>\n                    <SelectItem value=\"without-audits\">Without Paid Audits</SelectItem>\n                  </SelectContent>\n                </Select>\n\n                <Select value={`${sortBy}-${sortOrder}`} onValueChange={(value) => {\n                  const [field, order] = value.split('-');\n                  setSortBy(field as any);\n                  setSortOrder(order as any);\n                }}>\n                  <SelectTrigger className=\"w-full md:w-48\">\n                    <SelectValue placeholder=\"Sort by\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"date-desc\">Newest First</SelectItem>\n                    <SelectItem value=\"date-asc\">Oldest First</SelectItem>\n                    <SelectItem value=\"name-asc\">Name A-Z</SelectItem>\n                    <SelectItem value=\"name-desc\">Name Z-A</SelectItem>\n                    <SelectItem value=\"email-asc\">Email A-Z</SelectItem>\n                    <SelectItem value=\"email-desc\">Email Z-A</SelectItem>\n                    <SelectItem value=\"role-asc\">Role A-Z</SelectItem>\n                    <SelectItem value=\"role-desc\">Role Z-A</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Users Table */}\n              {filteredUsers.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500\">\n                  {users.length === 0 ? 'No users found.' : 'No users match your search criteria.'}\n                </div>\n              ) : (\n                <div className=\"rounded-md border\">\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead>User</TableHead>\n                        <TableHead>Email</TableHead>\n                        <TableHead>Role</TableHead>\n                        <TableHead>Joined</TableHead>\n                        <TableHead>Actions</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {filteredUsers.map((user) => (\n                        <TableRow key={user.id}>\n                          <TableCell>\n                            <div className=\"flex items-center space-x-3\">\n                              <div className=\"p-2 bg-blue-100 rounded-full\">\n                                <User className=\"w-4 h-4 text-blue-600\" />\n                              </div>\n                              <div>\n                                <div className=\"font-medium\">\n                                  {user.full_name || 'No name provided'}\n                                </div>\n                                <div className=\"text-sm text-gray-500\">\n                                  ID: {user.id.slice(0, 8)}...\n                                </div>\n                              </div>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center space-x-2\">\n                              <Mail className=\"w-3 h-3 text-gray-400\" />\n                              <span>{user.email}</span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <Badge \n                              variant={user.role === 'admin' ? 'default' : 'secondary'}\n                              className=\"flex items-center space-x-1 w-fit\"\n                            >\n                              <Shield className=\"w-3 h-3\" />\n                              <span>{user.role}</span>\n                            </Badge>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center space-x-2 text-sm\">\n                              <Calendar className=\"w-3 h-3 text-gray-400\" />\n                              <span>{new Date(user.created_at).toLocaleDateString()}</span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex flex-col space-y-2\">\n                              {user.paidAudits && user.paidAudits.length > 0 ? (\n                                <>\n                                  <div className=\"flex items-center space-x-2 text-sm text-green-600\">\n                                    <CheckCircle className=\"w-4 h-4\" />\n                                    <span>{user.paidAudits.length} Paid Audit{user.paidAudits.length > 1 ? 's' : ''}</span>\n                                  </div>\n                                  <div className=\"flex space-x-1\">\n                                    <Button\n                                      size=\"sm\"\n                                      variant=\"outline\"\n                                      onClick={() => openUploadDialog(user, 'manage')}\n                                      className=\"flex items-center space-x-1 text-xs px-2 py-1\"\n                                    >\n                                      <FileText className=\"w-3 h-3\" />\n                                      <span>Manage</span>\n                                    </Button>\n                                    <Button\n                                      size=\"sm\"\n                                      variant=\"outline\"\n                                      onClick={() => openUploadDialog(user, 'upload')}\n                                      className=\"flex items-center space-x-1 text-xs px-2 py-1\"\n                                    >\n                                      <Plus className=\"w-3 h-3\" />\n                                      <span>Add More</span>\n                                    </Button>\n                                  </div>\n                                </>\n                              ) : (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => openUploadDialog(user, 'upload')}\n                                  className=\"flex items-center space-x-1\"\n                                >\n                                  <Upload className=\"w-3 h-3\" />\n                                  <span>Upload to Paid Audit</span>\n                                </Button>\n                              )}\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\n            <DialogContent className=\"max-w-2xl\">\n              <DialogHeader>\n                <DialogTitle>\n                  {actionType === 'upload' ? 'Upload Paid Audit Report PDF' : 'Manage Paid Audits'}\n                </DialogTitle>\n                <DialogDescription>\n                  {actionType === 'upload' \n                    ? `Upload a PDF audit report for ${selectedUser?.full_name || selectedUser?.email}. This will appear in their Paid Audit module on their dashboard.`\n                    : `Manage existing paid audits for ${selectedUser?.full_name || selectedUser?.email}.`\n                  }\n                </DialogDescription>\n              </DialogHeader>\n              \n              {actionType === 'manage' && selectedUser?.paidAudits && selectedUser.paidAudits.length > 0 && (\n                <div className=\"space-y-4 mb-6\">\n                  <h4 className=\"font-medium text-sm text-gray-700\">Existing Audits:</h4>\n                  <div className=\"space-y-2\">\n                    {selectedUser.paidAudits.map((audit) => (\n                      <div key={audit.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                        <div>\n                          <p className=\"font-medium text-sm\">{audit.client_name}</p>\n                          <p className=\"text-xs text-gray-500\">\n                            Uploaded: {new Date(audit.created_at).toLocaleDateString()}\n                          </p>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"destructive\"\n                          onClick={() => handleRemoveAudit(audit.id)}\n                          className=\"flex items-center space-x-1\"\n                        >\n                          <Trash2 className=\"w-3 h-3\" />\n                          <span>Remove</span>\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {(actionType === 'upload' || actionType === 'manage') && (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium text-sm text-gray-700\">\n                    {actionType === 'manage' ? 'Upload Additional Audit:' : 'Upload New Audit:'}\n                  </h4>\n                  <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors\">\n                    <FileText className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                    <div className=\"text-sm text-gray-600 mb-4\">\n                      Click to select PDF file or drag and drop\n                    </div>\n                    <input\n                      id=\"pdf-upload\"\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handlePdfUpload}\n                      className=\"hidden\"\n                      disabled={uploading}\n                    />\n                    <Button \n                      variant=\"outline\" \n                      disabled={uploading}\n                      onClick={() => document.getElementById('pdf-upload')?.click()}\n                      className=\"hover:bg-blue-50\"\n                    >\n                      {uploading ? 'Uploading...' : 'Choose PDF File'}\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </DialogContent>\n          </Dialog>\n        </div>\n      </SidebarInset>\n    </SidebarProvider>\n  );\n};\n\nexport default AdminUsers;\n"],"names":[],"mappings":"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"}