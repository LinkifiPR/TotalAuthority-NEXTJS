{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\nimport { createServerClient } from '@supabase/ssr';\n\nexport async function middleware(request: NextRequest) {\n  const response = NextResponse.next({\n    request: {\n      headers: request.headers,\n    },\n  });\n\n  const supabase = createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return request.cookies.getAll();\n        },\n        setAll(cookiesToSet) {\n          cookiesToSet.forEach(({ name, value, options }) => {\n            request.cookies.set(name, value);\n            response.cookies.set(name, value, options);\n          });\n        },\n      },\n    }\n  );\n\n  const { data: { session } } = await supabase.auth.getSession();\n\n  const pathname = request.nextUrl.pathname;\n\n  if (pathname.startsWith('/admin')) {\n    if (!session) {\n      const url = request.nextUrl.clone();\n      url.pathname = '/auth';\n      url.searchParams.set('admin', 'true');\n      return NextResponse.redirect(url);\n    }\n\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (user) {\n      const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single();\n\n      if (profile?.role !== 'admin') {\n        const url = request.nextUrl.clone();\n        url.pathname = '/dashboard';\n        return NextResponse.redirect(url);\n      }\n    }\n  }\n\n  if (pathname === '/dashboard') {\n    if (!session) {\n      const url = request.nextUrl.clone();\n      url.pathname = '/auth';\n      return NextResponse.redirect(url);\n    }\n  }\n\n  return response;\n}\n\nexport const config = {\n  matcher: ['/admin/:path*', '/dashboard'],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;AAAA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,WAAW,gMAAY,CAAC,IAAI,CAAC;QACjC,SAAS;YACP,SAAS,QAAQ,OAAO;QAC1B;IACF;IAEA,MAAM,WAAW,IAAA,uMAAkB,sUAGjC;QACE,SAAS;YACP;gBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;YAC/B;YACA,QAAO,YAAY;gBACjB,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;oBAC5C,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;oBAC1B,SAAS,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;gBACpC;YACF;QACF;IACF;IAGF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;IAE5D,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,IAAI,SAAS,UAAU,CAAC,WAAW;QACjC,IAAI,CAAC,SAAS;YACZ,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;YACjC,IAAI,QAAQ,GAAG;YACf,IAAI,YAAY,CAAC,GAAG,CAAC,SAAS;YAC9B,OAAO,gMAAY,CAAC,QAAQ,CAAC;QAC/B;QAEA,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAEtD,IAAI,MAAM;YACR,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;YAET,IAAI,SAAS,SAAS,SAAS;gBAC7B,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;gBACjC,IAAI,QAAQ,GAAG;gBACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;YAC/B;QACF;IACF;IAEA,IAAI,aAAa,cAAc;QAC7B,IAAI,CAAC,SAAS;YACZ,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;YACjC,IAAI,QAAQ,GAAG;YACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;QAC/B;IACF;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;KAAa;AAC1C"}}]
}